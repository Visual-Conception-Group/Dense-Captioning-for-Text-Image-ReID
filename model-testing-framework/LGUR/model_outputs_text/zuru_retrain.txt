dict_keys(['id', 'img_path', 'same_id_index', 'lstm_caption_id', 'bert_caption_id', 'captions'])
ZURU_Combined-train has 35000 pohtos
ZURU_Combined-val has 6000 pohtos, 6000 text
using stride: [16, 16], and patch number is num_y24 * num_x8
using drop_out rate is : 0.0
using attn_drop_out rate is : 0.0
using drop_path rate is : 0.1
distill need to choose right cls token in the pth
Resized position embedding from size:torch.Size([1, 197, 768]) to size: torch.Size([1, 193, 768]) with height:24 width: 8
Loading pretrained ImageNet model......from ./deit_base_distilled_patch16_224-df68dfff.pth
Loaded model successfully!
model_get
Testing Epoch: 1 Iteration:546
similarity_all:
t2i: @R1: 0.1345, @R5: 0.2495, @R10: 0.3188, map: 0.1866
t2i_wm: @R1: 0.1345, @R5: 0.2493, @R10: 0.3187, map: 0.1628
model_get
Testing Epoch: 2 Iteration:546
similarity_all:
t2i: @R1: 0.2608, @R5: 0.4163, @R10: 0.496, map: 0.3229
t2i_wm: @R1: 0.261, @R5: 0.4163, @R10: 0.496, map: 0.2949
model_get
Testing Epoch: 3 Iteration:546
similarity_all:
t2i: @R1: 0.3023, @R5: 0.4673, @R10: 0.5537, map: 0.3678
t2i_wm: @R1: 0.3022, @R5: 0.4672, @R10: 0.5537, map: 0.3381
model_get
Testing Epoch: 4 Iteration:546
similarity_all:
t2i: @R1: 0.336, @R5: 0.5, @R10: 0.5722, map: 0.3991
t2i_wm: @R1: 0.3357, @R5: 0.5, @R10: 0.5722, map: 0.3704
model_get
Testing Epoch: 5 Iteration:546
similarity_all:
t2i: @R1: 0.3607, @R5: 0.534, @R10: 0.6102, map: 0.4262
t2i_wm: @R1: 0.36, @R5: 0.5338, @R10: 0.6103, map: 0.3963
model_get
Testing Epoch: 6 Iteration:546
similarity_all:
t2i: @R1: 0.401, @R5: 0.579, @R10: 0.6538, map: 0.4671
t2i_wm: @R1: 0.4008, @R5: 0.5788, @R10: 0.654, map: 0.4374
model_get
Testing Epoch: 7 Iteration:546
similarity_all:
t2i: @R1: 0.386, @R5: 0.5603, @R10: 0.6325, map: 0.45
t2i_wm: @R1: 0.3858, @R5: 0.5603, @R10: 0.6325, map: 0.4211
model_get
Testing Epoch: 8 Iteration:546
similarity_all:
t2i: @R1: 0.4083, @R5: 0.5925, @R10: 0.6628, map: 0.4743
t2i_wm: @R1: 0.4082, @R5: 0.5925, @R10: 0.6627, map: 0.4446
model_get
Testing Epoch: 9 Iteration:546
similarity_all:
t2i: @R1: 0.4128, @R5: 0.592, @R10: 0.6623, map: 0.478
t2i_wm: @R1: 0.4127, @R5: 0.592, @R10: 0.6625, map: 0.4487
model_get
Testing Epoch: 10 Iteration:546
similarity_all:
t2i: @R1: 0.4205, @R5: 0.5882, @R10: 0.6615, map: 0.4827
t2i_wm: @R1: 0.4202, @R5: 0.588, @R10: 0.6615, map: 0.4546
model_get
Testing Epoch: 11 Iteration:546
similarity_all:
t2i: @R1: 0.4227, @R5: 0.59, @R10: 0.6617, map: 0.4851
t2i_wm: @R1: 0.4227, @R5: 0.59, @R10: 0.6613, map: 0.4571
model_get
Testing Epoch: 12 Iteration:546
similarity_all:
t2i: @R1: 0.4363, @R5: 0.6067, @R10: 0.674, map: 0.4978
t2i_wm: @R1: 0.4363, @R5: 0.6067, @R10: 0.674, map: 0.4703
model_get
Testing Epoch: 13 Iteration:546
similarity_all:
t2i: @R1: 0.439, @R5: 0.6127, @R10: 0.6818, map: 0.5016
t2i_wm: @R1: 0.4388, @R5: 0.6128, @R10: 0.6818, map: 0.4735
model_get
Testing Epoch: 14 Iteration:546
similarity_all:
t2i: @R1: 0.4433, @R5: 0.6185, @R10: 0.6898, map: 0.5068
t2i_wm: @R1: 0.4432, @R5: 0.6182, @R10: 0.6897, map: 0.4784
model_get
Testing Epoch: 15 Iteration:546
similarity_all:
t2i: @R1: 0.4253, @R5: 0.6063, @R10: 0.6802, map: 0.4903
t2i_wm: @R1: 0.4252, @R5: 0.6065, @R10: 0.6802, map: 0.4612
model_get
Testing Epoch: 16 Iteration:546
similarity_all:
t2i: @R1: 0.4368, @R5: 0.6113, @R10: 0.6792, map: 0.5001
t2i_wm: @R1: 0.4368, @R5: 0.6112, @R10: 0.6792, map: 0.4718
model_get
Testing Epoch: 17 Iteration:546
similarity_all:
t2i: @R1: 0.438, @R5: 0.6103, @R10: 0.6803, map: 0.4998
t2i_wm: @R1: 0.4378, @R5: 0.6102, @R10: 0.68, map: 0.4719
model_get
Testing Epoch: 18 Iteration:546
similarity_all:
t2i: @R1: 0.4345, @R5: 0.6132, @R10: 0.682, map: 0.4982
t2i_wm: @R1: 0.4348, @R5: 0.6128, @R10: 0.6818, map: 0.47
model_get
Testing Epoch: 19 Iteration:546
similarity_all:
t2i: @R1: 0.4443, @R5: 0.6187, @R10: 0.687, map: 0.5061
t2i_wm: @R1: 0.4437, @R5: 0.6185, @R10: 0.687, map: 0.478
model_get
Testing Epoch: 20 Iteration:546
similarity_all:
t2i: @R1: 0.4707, @R5: 0.639, @R10: 0.7065, map: 0.5306
t2i_wm: @R1: 0.4707, @R5: 0.6393, @R10: 0.7067, map: 0.5039
model_get
Testing Epoch: 21 Iteration:546
similarity_all:
t2i: @R1: 0.4705, @R5: 0.6382, @R10: 0.707, map: 0.5312
t2i_wm: @R1: 0.4705, @R5: 0.638, @R10: 0.707, map: 0.504
model_get
Testing Epoch: 22 Iteration:546
similarity_all:
t2i: @R1: 0.469, @R5: 0.6395, @R10: 0.707, map: 0.5305
t2i_wm: @R1: 0.4687, @R5: 0.6395, @R10: 0.707, map: 0.5028
model_get
Testing Epoch: 23 Iteration:546
similarity_all:
t2i: @R1: 0.476, @R5: 0.6427, @R10: 0.7128, map: 0.5366
t2i_wm: @R1: 0.4762, @R5: 0.6423, @R10: 0.7128, map: 0.5096
model_get
Testing Epoch: 24 Iteration:546
similarity_all:
t2i: @R1: 0.4722, @R5: 0.6377, @R10: 0.707, map: 0.5322
t2i_wm: @R1: 0.4713, @R5: 0.6377, @R10: 0.7068, map: 0.5047
model_get
Testing Epoch: 25 Iteration:546
similarity_all:
t2i: @R1: 0.4712, @R5: 0.6405, @R10: 0.7077, map: 0.5322
t2i_wm: @R1: 0.471, @R5: 0.6403, @R10: 0.7077, map: 0.5048
model_get
Testing Epoch: 26 Iteration:546
similarity_all:
t2i: @R1: 0.4737, @R5: 0.6398, @R10: 0.7082, map: 0.5339
t2i_wm: @R1: 0.4733, @R5: 0.6398, @R10: 0.7082, map: 0.5068
model_get
Testing Epoch: 27 Iteration:546
similarity_all:
t2i: @R1: 0.4725, @R5: 0.6457, @R10: 0.7138, map: 0.5339
t2i_wm: @R1: 0.4727, @R5: 0.6457, @R10: 0.7137, map: 0.5066
model_get
Testing Epoch: 28 Iteration:546
similarity_all:
t2i: @R1: 0.4788, @R5: 0.6412, @R10: 0.7128, map: 0.5388
t2i_wm: @R1: 0.4792, @R5: 0.6412, @R10: 0.7125, map: 0.5123
model_get
Testing Epoch: 29 Iteration:546
similarity_all:
t2i: @R1: 0.4752, @R5: 0.6417, @R10: 0.7108, map: 0.5356
t2i_wm: @R1: 0.475, @R5: 0.6417, @R10: 0.7107, map: 0.5084
model_get
Testing Epoch: 30 Iteration:546
similarity_all:
t2i: @R1: 0.4778, @R5: 0.6445, @R10: 0.7097, map: 0.5378
t2i_wm: @R1: 0.478, @R5: 0.6445, @R10: 0.7095, map: 0.5111
model_get
Testing Epoch: 31 Iteration:546
similarity_all:
t2i: @R1: 0.4735, @R5: 0.6398, @R10: 0.7052, map: 0.5339
t2i_wm: @R1: 0.4728, @R5: 0.6398, @R10: 0.7048, map: 0.5064
model_get
Testing Epoch: 32 Iteration:546
similarity_all:
t2i: @R1: 0.4767, @R5: 0.6403, @R10: 0.7045, map: 0.5355
t2i_wm: @R1: 0.4765, @R5: 0.6403, @R10: 0.7043, map: 0.5091
model_get
Testing Epoch: 33 Iteration:546
similarity_all:
t2i: @R1: 0.4782, @R5: 0.6398, @R10: 0.709, map: 0.5371
t2i_wm: @R1: 0.4782, @R5: 0.6398, @R10: 0.709, map: 0.5108
model_get
Testing Epoch: 34 Iteration:546
similarity_all:
t2i: @R1: 0.4738, @R5: 0.6432, @R10: 0.7097, map: 0.5345
t2i_wm: @R1: 0.4733, @R5: 0.643, @R10: 0.7095, map: 0.507
model_get
Testing Epoch: 35 Iteration:546
similarity_all:
t2i: @R1: 0.473, @R5: 0.6403, @R10: 0.7072, map: 0.5335
t2i_wm: @R1: 0.4722, @R5: 0.6403, @R10: 0.707, map: 0.5058
model_get
Testing Epoch: 36 Iteration:546
similarity_all:
t2i: @R1: 0.4723, @R5: 0.6402, @R10: 0.7082, map: 0.5328
t2i_wm: @R1: 0.4722, @R5: 0.6402, @R10: 0.7083, map: 0.5057
model_get
Testing Epoch: 37 Iteration:546
similarity_all:
t2i: @R1: 0.4703, @R5: 0.6392, @R10: 0.703, map: 0.531
t2i_wm: @R1: 0.4702, @R5: 0.6392, @R10: 0.7028, map: 0.5038
model_get
Testing Epoch: 38 Iteration:546
similarity_all:
t2i: @R1: 0.4707, @R5: 0.6368, @R10: 0.7035, map: 0.5309
t2i_wm: @R1: 0.4708, @R5: 0.6367, @R10: 0.7035, map: 0.5041
model_get
Testing Epoch: 39 Iteration:546
similarity_all:
t2i: @R1: 0.4712, @R5: 0.6408, @R10: 0.7065, map: 0.5319
t2i_wm: @R1: 0.4708, @R5: 0.6408, @R10: 0.7063, map: 0.5045
model_get
Testing Epoch: 40 Iteration:546
similarity_all:
t2i: @R1: 0.4753, @R5: 0.64, @R10: 0.7058, map: 0.5348
t2i_wm: @R1: 0.4748, @R5: 0.64, @R10: 0.7057, map: 0.5079
model_get
Testing Epoch: 41 Iteration:546
similarity_all:
t2i: @R1: 0.4748, @R5: 0.6412, @R10: 0.7058, map: 0.5345
t2i_wm: @R1: 0.4747, @R5: 0.6412, @R10: 0.7057, map: 0.5076
model_get
Testing Epoch: 42 Iteration:546
similarity_all:
t2i: @R1: 0.476, @R5: 0.6408, @R10: 0.7073, map: 0.5354
t2i_wm: @R1: 0.4758, @R5: 0.6408, @R10: 0.7072, map: 0.5087
model_get
Testing Epoch: 43 Iteration:546
similarity_all:
t2i: @R1: 0.4758, @R5: 0.6413, @R10: 0.7082, map: 0.5355
t2i_wm: @R1: 0.4758, @R5: 0.6413, @R10: 0.708, map: 0.5089
model_get
Testing Epoch: 44 Iteration:546
similarity_all:
t2i: @R1: 0.4765, @R5: 0.641, @R10: 0.706, map: 0.5358
t2i_wm: @R1: 0.4762, @R5: 0.641, @R10: 0.7057, map: 0.509
model_get
Testing Epoch: 45 Iteration:546
similarity_all:
t2i: @R1: 0.4757, @R5: 0.6402, @R10: 0.7067, map: 0.5351
t2i_wm: @R1: 0.4755, @R5: 0.6402, @R10: 0.7063, map: 0.5084
model_get
Testing Epoch: 46 Iteration:546
similarity_all:
t2i: @R1: 0.4768, @R5: 0.6392, @R10: 0.7063, map: 0.536
t2i_wm: @R1: 0.4767, @R5: 0.6392, @R10: 0.706, map: 0.5095
model_get
Testing Epoch: 47 Iteration:546
similarity_all:
t2i: @R1: 0.4755, @R5: 0.6385, @R10: 0.7077, map: 0.535
t2i_wm: @R1: 0.4752, @R5: 0.6385, @R10: 0.7077, map: 0.5082
model_get
Testing Epoch: 48 Iteration:546
similarity_all:
t2i: @R1: 0.4748, @R5: 0.6395, @R10: 0.7062, map: 0.5347
t2i_wm: @R1: 0.4748, @R5: 0.6395, @R10: 0.7062, map: 0.508
model_get
Testing Epoch: 49 Iteration:546
similarity_all:
t2i: @R1: 0.4768, @R5: 0.6405, @R10: 0.7057, map: 0.5363
t2i_wm: @R1: 0.4773, @R5: 0.6405, @R10: 0.7053, map: 0.5101
model_get
Testing Epoch: 50 Iteration:546
similarity_all:
t2i: @R1: 0.4775, @R5: 0.6402, @R10: 0.7057, map: 0.5366
t2i_wm: @R1: 0.477, @R5: 0.6402, @R10: 0.7053, map: 0.5098
model_get
Testing Epoch: 51 Iteration:546
similarity_all:
t2i: @R1: 0.4775, @R5: 0.641, @R10: 0.7057, map: 0.5365
t2i_wm: @R1: 0.4768, @R5: 0.641, @R10: 0.7057, map: 0.5097
model_get
Testing Epoch: 52 Iteration:546
similarity_all:
t2i: @R1: 0.4767, @R5: 0.6405, @R10: 0.7063, map: 0.5361
t2i_wm: @R1: 0.4772, @R5: 0.6405, @R10: 0.7062, map: 0.5099
model_get
Testing Epoch: 53 Iteration:546
similarity_all:
t2i: @R1: 0.4772, @R5: 0.6405, @R10: 0.7062, map: 0.5364
t2i_wm: @R1: 0.477, @R5: 0.6405, @R10: 0.706, map: 0.5098
model_get
Testing Epoch: 54 Iteration:546
similarity_all:
t2i: @R1: 0.4773, @R5: 0.641, @R10: 0.7058, map: 0.5365
t2i_wm: @R1: 0.4767, @R5: 0.641, @R10: 0.7058, map: 0.5096
model_get
Testing Epoch: 55 Iteration:546
similarity_all:
t2i: @R1: 0.477, @R5: 0.641, @R10: 0.706, map: 0.5363
t2i_wm: @R1: 0.4763, @R5: 0.641, @R10: 0.7057, map: 0.5094
model_get
Testing Epoch: 56 Iteration:546
similarity_all:
t2i: @R1: 0.4768, @R5: 0.6407, @R10: 0.7065, map: 0.5362
t2i_wm: @R1: 0.4763, @R5: 0.6407, @R10: 0.7065, map: 0.5093
model_get
Testing Epoch: 57 Iteration:546
similarity_all:
t2i: @R1: 0.4768, @R5: 0.6405, @R10: 0.7058, map: 0.536
t2i_wm: @R1: 0.4762, @R5: 0.6405, @R10: 0.7053, map: 0.5091
model_get
Testing Epoch: 58 Iteration:546
similarity_all:
t2i: @R1: 0.4773, @R5: 0.6405, @R10: 0.7055, map: 0.5364
t2i_wm: @R1: 0.4767, @R5: 0.6405, @R10: 0.7055, map: 0.5096
model_get
Testing Epoch: 59 Iteration:546
similarity_all:
t2i: @R1: 0.4768, @R5: 0.6408, @R10: 0.7053, map: 0.5362
t2i_wm: @R1: 0.4767, @R5: 0.6408, @R10: 0.7055, map: 0.5095
model_get
Testing Epoch: 60 Iteration:546
similarity_all:
t2i: @R1: 0.4767, @R5: 0.6405, @R10: 0.706, map: 0.536
t2i_wm: @R1: 0.4762, @R5: 0.6405, @R10: 0.7058, map: 0.5091
