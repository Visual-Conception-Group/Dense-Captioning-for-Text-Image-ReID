dict_keys(['id', 'img_path', 'same_id_index', 'lstm_caption_id', 'bert_caption_id', 'captions'])
ZURU-train has 30000 pohtos
ZURU-val has 5000 pohtos, 5000 text
using stride: [16, 16], and patch number is num_y24 * num_x8
using drop_out rate is : 0.0
using attn_drop_out rate is : 0.0
using drop_path rate is : 0.1
distill need to choose right cls token in the pth
Resized position embedding from size:torch.Size([1, 197, 768]) to size: torch.Size([1, 193, 768]) with height:24 width: 8
Loading pretrained ImageNet model......from ./deit_base_distilled_patch16_224-df68dfff.pth
Loaded model successfully!
model_get
Testing Epoch: 1 Iteration:468
similarity_all:
t2i: @R1: 0.1294, @R5: 0.2396, @R10: 0.3062, map: 0.1793
t2i_wm: @R1: 0.1294, @R5: 0.2396, @R10: 0.3062, map: 0.1565
model_get
Testing Epoch: 2 Iteration:468
similarity_all:
t2i: @R1: 0.2738, @R5: 0.4472, @R10: 0.5198, map: 0.3395
t2i_wm: @R1: 0.2738, @R5: 0.4472, @R10: 0.5198, map: 0.3098
model_get
Testing Epoch: 3 Iteration:468
similarity_all:
t2i: @R1: 0.3344, @R5: 0.5122, @R10: 0.5912, map: 0.4016
t2i_wm: @R1: 0.3344, @R5: 0.5122, @R10: 0.5912, map: 0.3714
model_get
Testing Epoch: 4 Iteration:468
similarity_all:
t2i: @R1: 0.3676, @R5: 0.5454, @R10: 0.6196, map: 0.434
t2i_wm: @R1: 0.3676, @R5: 0.5454, @R10: 0.6196, map: 0.4042
model_get
Testing Epoch: 5 Iteration:468
similarity_all:
t2i: @R1: 0.3892, @R5: 0.561, @R10: 0.6326, map: 0.4534
t2i_wm: @R1: 0.3892, @R5: 0.561, @R10: 0.6326, map: 0.4246
model_get
Testing Epoch: 6 Iteration:468
similarity_all:
t2i: @R1: 0.4198, @R5: 0.5898, @R10: 0.6656, map: 0.483
t2i_wm: @R1: 0.4198, @R5: 0.5898, @R10: 0.6656, map: 0.4546
model_get
Testing Epoch: 7 Iteration:468
similarity_all:
t2i: @R1: 0.4192, @R5: 0.5976, @R10: 0.6712, map: 0.484
t2i_wm: @R1: 0.4192, @R5: 0.5976, @R10: 0.6712, map: 0.4549
model_get
Testing Epoch: 8 Iteration:468
similarity_all:
t2i: @R1: 0.4314, @R5: 0.611, @R10: 0.689, map: 0.4963
t2i_wm: @R1: 0.4314, @R5: 0.611, @R10: 0.689, map: 0.4672
model_get
Testing Epoch: 9 Iteration:468
similarity_all:
t2i: @R1: 0.4394, @R5: 0.6194, @R10: 0.6976, map: 0.5047
t2i_wm: @R1: 0.4394, @R5: 0.6194, @R10: 0.6976, map: 0.4754
model_get
Testing Epoch: 10 Iteration:468
similarity_all:
t2i: @R1: 0.4392, @R5: 0.6166, @R10: 0.6862, map: 0.5028
t2i_wm: @R1: 0.4392, @R5: 0.6166, @R10: 0.6862, map: 0.4743
model_get
Testing Epoch: 11 Iteration:468
similarity_all:
t2i: @R1: 0.4552, @R5: 0.6284, @R10: 0.6996, map: 0.5177
t2i_wm: @R1: 0.4552, @R5: 0.6284, @R10: 0.6996, map: 0.4897
model_get
Testing Epoch: 12 Iteration:468
similarity_all:
t2i: @R1: 0.4494, @R5: 0.6276, @R10: 0.6958, map: 0.5133
t2i_wm: @R1: 0.4494, @R5: 0.6276, @R10: 0.6958, map: 0.4847
model_get
Testing Epoch: 13 Iteration:468
similarity_all:
t2i: @R1: 0.4528, @R5: 0.6238, @R10: 0.6964, map: 0.5152
t2i_wm: @R1: 0.4528, @R5: 0.6238, @R10: 0.6964, map: 0.4873
model_get
Testing Epoch: 14 Iteration:468
similarity_all:
t2i: @R1: 0.4514, @R5: 0.6358, @R10: 0.7062, map: 0.5167
t2i_wm: @R1: 0.4514, @R5: 0.6358, @R10: 0.7062, map: 0.4875
model_get
Testing Epoch: 15 Iteration:468
similarity_all:
t2i: @R1: 0.4546, @R5: 0.6252, @R10: 0.7032, map: 0.5174
t2i_wm: @R1: 0.4546, @R5: 0.6252, @R10: 0.7032, map: 0.4893
model_get
Testing Epoch: 16 Iteration:468
similarity_all:
t2i: @R1: 0.4508, @R5: 0.6252, @R10: 0.6902, map: 0.513
t2i_wm: @R1: 0.4508, @R5: 0.6252, @R10: 0.6902, map: 0.4851
model_get
Testing Epoch: 17 Iteration:468
similarity_all:
t2i: @R1: 0.4572, @R5: 0.6266, @R10: 0.6976, map: 0.5195
t2i_wm: @R1: 0.4572, @R5: 0.6266, @R10: 0.6976, map: 0.4916
model_get
Testing Epoch: 18 Iteration:468
similarity_all:
t2i: @R1: 0.4618, @R5: 0.6292, @R10: 0.7032, map: 0.5229
t2i_wm: @R1: 0.4618, @R5: 0.6292, @R10: 0.7032, map: 0.4955
model_get
Testing Epoch: 19 Iteration:468
similarity_all:
t2i: @R1: 0.4642, @R5: 0.6266, @R10: 0.6974, map: 0.5237
t2i_wm: @R1: 0.4642, @R5: 0.6266, @R10: 0.6974, map: 0.497
model_get
Testing Epoch: 20 Iteration:468
similarity_all:
t2i: @R1: 0.4908, @R5: 0.6592, @R10: 0.7282, map: 0.5508
t2i_wm: @R1: 0.4908, @R5: 0.6592, @R10: 0.7282, map: 0.5239
model_get
Testing Epoch: 21 Iteration:468
similarity_all:
t2i: @R1: 0.4938, @R5: 0.662, @R10: 0.7328, map: 0.5538
t2i_wm: @R1: 0.4938, @R5: 0.662, @R10: 0.7328, map: 0.5269
model_get
Testing Epoch: 22 Iteration:468
similarity_all:
t2i: @R1: 0.498, @R5: 0.6634, @R10: 0.735, map: 0.5578
t2i_wm: @R1: 0.498, @R5: 0.6634, @R10: 0.735, map: 0.531
model_get
Testing Epoch: 23 Iteration:468
similarity_all:
t2i: @R1: 0.4984, @R5: 0.6656, @R10: 0.7356, map: 0.5584
t2i_wm: @R1: 0.4984, @R5: 0.6656, @R10: 0.7356, map: 0.5315
model_get
Testing Epoch: 24 Iteration:468
similarity_all:
t2i: @R1: 0.5024, @R5: 0.6728, @R10: 0.7392, map: 0.5628
t2i_wm: @R1: 0.5024, @R5: 0.6728, @R10: 0.7392, map: 0.5358
model_get
Testing Epoch: 25 Iteration:468
similarity_all:
t2i: @R1: 0.4984, @R5: 0.668, @R10: 0.7382, map: 0.5593
t2i_wm: @R1: 0.4984, @R5: 0.668, @R10: 0.7382, map: 0.5321
model_get
Testing Epoch: 26 Iteration:468
similarity_all:
t2i: @R1: 0.5004, @R5: 0.6668, @R10: 0.7374, map: 0.5605
t2i_wm: @R1: 0.5004, @R5: 0.6668, @R10: 0.7374, map: 0.5336
model_get
Testing Epoch: 27 Iteration:468
similarity_all:
t2i: @R1: 0.5002, @R5: 0.6668, @R10: 0.735, map: 0.5597
t2i_wm: @R1: 0.5002, @R5: 0.6668, @R10: 0.735, map: 0.533
model_get
Testing Epoch: 28 Iteration:468
similarity_all:
t2i: @R1: 0.501, @R5: 0.666, @R10: 0.7348, map: 0.5606
t2i_wm: @R1: 0.501, @R5: 0.666, @R10: 0.7348, map: 0.5339
model_get
Testing Epoch: 29 Iteration:468
similarity_all:
t2i: @R1: 0.499, @R5: 0.6694, @R10: 0.7354, map: 0.5587
t2i_wm: @R1: 0.499, @R5: 0.6694, @R10: 0.7354, map: 0.532
model_get
Testing Epoch: 30 Iteration:468
similarity_all:
t2i: @R1: 0.4956, @R5: 0.6688, @R10: 0.739, map: 0.557
t2i_wm: @R1: 0.4956, @R5: 0.6688, @R10: 0.739, map: 0.5296
model_get
Testing Epoch: 31 Iteration:468
similarity_all:
t2i: @R1: 0.4966, @R5: 0.6664, @R10: 0.7356, map: 0.5571
t2i_wm: @R1: 0.4966, @R5: 0.6664, @R10: 0.7356, map: 0.53
model_get
Testing Epoch: 32 Iteration:468
similarity_all:
t2i: @R1: 0.4976, @R5: 0.6698, @R10: 0.7338, map: 0.5587
t2i_wm: @R1: 0.4976, @R5: 0.6698, @R10: 0.7338, map: 0.5314
model_get
Testing Epoch: 33 Iteration:468
similarity_all:
t2i: @R1: 0.4976, @R5: 0.67, @R10: 0.7386, map: 0.5586
t2i_wm: @R1: 0.4976, @R5: 0.67, @R10: 0.7386, map: 0.5313
model_get
Testing Epoch: 34 Iteration:468
similarity_all:
t2i: @R1: 0.5, @R5: 0.6686, @R10: 0.7384, map: 0.5602
t2i_wm: @R1: 0.5, @R5: 0.6686, @R10: 0.7384, map: 0.5333
model_get
Testing Epoch: 35 Iteration:468
similarity_all:
t2i: @R1: 0.5002, @R5: 0.669, @R10: 0.733, map: 0.5602
t2i_wm: @R1: 0.5002, @R5: 0.669, @R10: 0.733, map: 0.5334
model_get
Testing Epoch: 36 Iteration:468
similarity_all:
t2i: @R1: 0.4962, @R5: 0.6644, @R10: 0.7322, map: 0.5562
t2i_wm: @R1: 0.4962, @R5: 0.6644, @R10: 0.7322, map: 0.5293
model_get
Testing Epoch: 37 Iteration:468
similarity_all:
t2i: @R1: 0.4968, @R5: 0.6652, @R10: 0.733, map: 0.5571
t2i_wm: @R1: 0.4968, @R5: 0.6652, @R10: 0.733, map: 0.5301
model_get
Testing Epoch: 38 Iteration:468
similarity_all:
t2i: @R1: 0.4962, @R5: 0.6678, @R10: 0.7352, map: 0.5575
t2i_wm: @R1: 0.4962, @R5: 0.6678, @R10: 0.7352, map: 0.5301
model_get
Testing Epoch: 39 Iteration:468
similarity_all:
t2i: @R1: 0.4942, @R5: 0.6704, @R10: 0.7344, map: 0.5561
t2i_wm: @R1: 0.4942, @R5: 0.6704, @R10: 0.7344, map: 0.5284
model_get
Testing Epoch: 40 Iteration:468
similarity_all:
t2i: @R1: 0.4998, @R5: 0.6702, @R10: 0.7346, map: 0.5603
t2i_wm: @R1: 0.4998, @R5: 0.6702, @R10: 0.7346, map: 0.5333
model_get
Testing Epoch: 41 Iteration:468
similarity_all:
t2i: @R1: 0.5012, @R5: 0.6716, @R10: 0.7372, map: 0.5616
t2i_wm: @R1: 0.5012, @R5: 0.6716, @R10: 0.7372, map: 0.5346
model_get
Testing Epoch: 42 Iteration:468
similarity_all:
t2i: @R1: 0.5006, @R5: 0.67, @R10: 0.737, map: 0.5607
t2i_wm: @R1: 0.5006, @R5: 0.67, @R10: 0.737, map: 0.5338
model_get
Testing Epoch: 43 Iteration:468
similarity_all:
t2i: @R1: 0.5012, @R5: 0.6706, @R10: 0.7366, map: 0.5613
t2i_wm: @R1: 0.5012, @R5: 0.6706, @R10: 0.7366, map: 0.5344
model_get
Testing Epoch: 44 Iteration:468
similarity_all:
t2i: @R1: 0.4988, @R5: 0.6684, @R10: 0.7356, map: 0.5594
t2i_wm: @R1: 0.4988, @R5: 0.6684, @R10: 0.7356, map: 0.5323
model_get
Testing Epoch: 45 Iteration:468
similarity_all:
t2i: @R1: 0.4996, @R5: 0.6688, @R10: 0.7342, map: 0.56
t2i_wm: @R1: 0.4996, @R5: 0.6688, @R10: 0.7342, map: 0.533
model_get
Testing Epoch: 46 Iteration:468
similarity_all:
t2i: @R1: 0.4984, @R5: 0.6696, @R10: 0.7344, map: 0.559
t2i_wm: @R1: 0.4984, @R5: 0.6696, @R10: 0.7344, map: 0.5319
model_get
Testing Epoch: 47 Iteration:468
similarity_all:
t2i: @R1: 0.4998, @R5: 0.6674, @R10: 0.735, map: 0.5599
t2i_wm: @R1: 0.4998, @R5: 0.6674, @R10: 0.735, map: 0.533
model_get
Testing Epoch: 48 Iteration:468
similarity_all:
t2i: @R1: 0.5014, @R5: 0.6666, @R10: 0.7336, map: 0.561
t2i_wm: @R1: 0.5014, @R5: 0.6666, @R10: 0.7336, map: 0.5343
model_get
Testing Epoch: 49 Iteration:468
similarity_all:
t2i: @R1: 0.4986, @R5: 0.6682, @R10: 0.736, map: 0.5594
t2i_wm: @R1: 0.4986, @R5: 0.6682, @R10: 0.736, map: 0.5323
model_get
Testing Epoch: 50 Iteration:468
similarity_all:
t2i: @R1: 0.499, @R5: 0.6686, @R10: 0.7364, map: 0.5598
t2i_wm: @R1: 0.499, @R5: 0.6686, @R10: 0.7364, map: 0.5326
model_get
Testing Epoch: 51 Iteration:468
similarity_all:
t2i: @R1: 0.4982, @R5: 0.6684, @R10: 0.7364, map: 0.5592
t2i_wm: @R1: 0.4982, @R5: 0.6684, @R10: 0.7364, map: 0.532
model_get
Testing Epoch: 52 Iteration:468
similarity_all:
t2i: @R1: 0.4984, @R5: 0.6688, @R10: 0.7362, map: 0.5594
t2i_wm: @R1: 0.4984, @R5: 0.6688, @R10: 0.7362, map: 0.5322
model_get
Testing Epoch: 53 Iteration:468
similarity_all:
t2i: @R1: 0.4982, @R5: 0.6694, @R10: 0.7352, map: 0.5592
t2i_wm: @R1: 0.4982, @R5: 0.6694, @R10: 0.7352, map: 0.5319
model_get
Testing Epoch: 54 Iteration:468
similarity_all:
t2i: @R1: 0.4982, @R5: 0.6694, @R10: 0.7346, map: 0.5591
t2i_wm: @R1: 0.4982, @R5: 0.6694, @R10: 0.7346, map: 0.5319
model_get
Testing Epoch: 55 Iteration:468
similarity_all:
t2i: @R1: 0.498, @R5: 0.669, @R10: 0.735, map: 0.5591
t2i_wm: @R1: 0.498, @R5: 0.669, @R10: 0.735, map: 0.5318
model_get
Testing Epoch: 56 Iteration:468
similarity_all:
t2i: @R1: 0.498, @R5: 0.67, @R10: 0.7352, map: 0.5591
t2i_wm: @R1: 0.498, @R5: 0.67, @R10: 0.7352, map: 0.5318
model_get
Testing Epoch: 57 Iteration:468
similarity_all:
t2i: @R1: 0.4984, @R5: 0.6696, @R10: 0.7354, map: 0.5593
t2i_wm: @R1: 0.4984, @R5: 0.6696, @R10: 0.7354, map: 0.5321
model_get
Testing Epoch: 58 Iteration:468
similarity_all:
t2i: @R1: 0.4982, @R5: 0.6692, @R10: 0.7352, map: 0.5591
t2i_wm: @R1: 0.4982, @R5: 0.6692, @R10: 0.7352, map: 0.5319
model_get
Testing Epoch: 59 Iteration:468
similarity_all:
t2i: @R1: 0.498, @R5: 0.6688, @R10: 0.7352, map: 0.5589
t2i_wm: @R1: 0.498, @R5: 0.6688, @R10: 0.7352, map: 0.5317
model_get
Testing Epoch: 60 Iteration:468
similarity_all:
t2i: @R1: 0.4984, @R5: 0.669, @R10: 0.7358, map: 0.5592
t2i_wm: @R1: 0.4984, @R5: 0.669, @R10: 0.7358, map: 0.5321
